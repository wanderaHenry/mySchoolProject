doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    title Agric Produce Market
    link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet")
    link(href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet")
    link(rel="stylesheet", href="/style.css")

  body(data-page="market")
    // Navbar
    nav.navbar.navbar-expand-lg.navbar-light.bg-white.shadow-sm.px-4
      a.navbar-brand(href="/dashboard") Farm Connect
      button.navbar-toggler(type="button", data-bs-toggle="collapse", data-bs-target="#navbarNav")
        span.navbar-toggler-icon
      #navbarNav.collapse.navbar-collapse
        ul.navbar-nav.ms-auto
          li.nav-item
            a.nav-link(href="/dashboard") Dashboard
          li.nav-item
            a.nav-link(href="/products") My Products
          li.nav-item
            a.nav-link(href="/products/market") Market
          li.nav-item
            a.nav-link(href="/orders") Orders
          li.nav-item
            a.nav-link(href="/settings") Settings
          li.nav-item
            a.nav-link(href="/logout") Logout
        img.rounded-circle.ms-3(src="https://via.placeholder.com/40", alt="Profile")

    // Heading
    .container.text-center.mt-4
      h4 Welcome To Agric Produce Market, #{user.name}

    // Product Grid
    .container.mt-4
      if products.length === 0
        p.text-center.text-muted No products available in the market yet.
      else
        .row.row-cols-1.row-cols-md-3.g-4.justify-content-center
          each product in products
            .col
              .card.h-100
                if product.image
                  img.card-img-top(src=product.image, alt=product.name)
                else
                  img.card-img-top(src="https://via.placeholder.com/120x100", alt=product.name)
                .card-body
                  h5.card-title #{product.name}
                  p.card-text #{product.description}
                  p.text-success $#{product.price.toLocaleString()}
                  p.text-muted Seller: #{product.seller ? product.seller.name : "Unknown"}
                  // Request form
                  form(action="/orders/create", method="POST")
                    input(type="hidden", name="productId", value=product._id)
                    button.btn.btn-primary.btn-sm(type="submit") Request

    // Footer
    .footer.bg-light.text-center.py-3.mt-5
      p &copy; #{new Date().getFullYear()} Farm Connect
      p Contact: henrywandera138@gmail.com | +256 767 127 641

    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js")
